<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2497.995402319526" height="1379.931148952318"><desc>%40startuml%0Atitle%20Login%20Flow%20with%20OAuth%0A%0Aactor%20User%0Aparticipant%20Browser%0Aparticipant%20%22OAuth%20Provider%20(HCMUT_SSO)%22%20as%20OAuth%0Aparticipant%20%22Auth%20Controller%22%20as%20AuthController%0Aparticipant%20%22Auth%20Service%22%20as%20AuthService%0Aparticipant%20%22User%20Service%22%20as%20UserService%0Aparticipant%20%22User%20Repository%22%20as%20UserRepo%0Aparticipant%20Database%0Aparticipant%20%22Token%20Service%22%20as%20TokenService%0A%0Aactivate%20User%0Aactivate%20Browser%0AUser%20-%3E%20Browser%3A%20Select%20role%20(mentee%2Fmentor%2Fadmin)%0A%0ABrowser%20-%3E%20AuthController%3A%20GET%20%2Fapi%2Fauth%2Fsignin%3Frole%3D%5Brole%5D%0Aactivate%20AuthController%0AAuthController%20-%3E%20OAuth%3A%20Redirect%20to%20OAuth%20login%0A%0Aactivate%20OAuth%0AOAuth%20-%3E%20User%3A%20Show%20consent%20screen%0AUser%20-%3E%20OAuth%3A%20Grant%20permission%0AOAuth%20-%3E%20AuthController%3A%20Return%20authorization%20code%20%2B%20redirect%0Adeactivate%20OAuth%0A%0AAuthController%20-%3E%20AuthService%3A%20handleSignIn(profile%2C%20account)%0Aactivate%20AuthService%0AAuthService%20-%3E%20UserService%3A%20findUser(email%2C%20profile)%0Aactivate%20UserService%0AUserService%20-%3E%20UserRepo%3A%20findByEmail%20and%20Role(email%2C%20role)%0Aactivate%20UserRepo%0AUserRepo%20-%3E%20Database%3A%20user.findUnique(%7Bwhere%3A%20%7Bemail%2C%20role%7D%7D)%0Aactivate%20Database%0ADatabase%20-%3E%20UserRepo%3A%20User%20data%20%7C%20null%0Adeactivate%20Database%0A%0AUserRepo%20-%3E%20UserService%3A%20User%20data%20%7C%20null%0Adeactivate%20UserRepo%0AUserService%20-%3E%20AuthService%3A%20User%20record%0Adeactivate%20UserService%0A%0Aalt%20If%20user%20exists%0A%20%20%20%20AuthService%20-%3E%20TokenService%3A%20createToken(%7BuserId%2C%20email%2C%20name%7D)%0A%20%20%20%20activate%20TokenService%0A%20%20%20%20TokenService%20-%3E%20TokenService%3A%20jwt.sign(payload%2C%20secret%2C%20%7BexpiresIn%3A%20'24h'%7D)%0A%20%20%20%20TokenService%20-%3E%20AuthService%3A%20JWT%20access%20token%0A%20%20%20%20deactivate%20TokenService%0A%20%20%20%20AuthService%20-%3E%20AuthController%3A%20%7Buser%2C%20accessToken%7D%0A%20%20%20%20AuthController%20-%3E%20Browser%3A%20Set%20session%20cookie%20%2B%20redirect%20to%20%2F%0A%20%20%20%20Browser%20-%3E%20User%3A%20Render%20homepage%0Aelse%20User%20not%20found%0A%20%20%20%20UserService%20-%3E%20AuthService%3A%20Throw%20exception%20not%20found%0A%20%20%20%20AuthService%20-%3E%20AuthController%3A%20Return%20403%3A%20Unauthorized%20%2B%20redirect%20to%20%2Ferror_403%0A%20%20%20%20deactivate%20AuthService%0A%20%20%20%20AuthController%20-%3E%20Browser%3A%20Redirect%20to%20error%20page%0A%20%20%20%20deactivate%20AuthController%0A%20%20%20%20Browser%20-%3E%20User%3A%20Render%20error%20page%0Aend%20alt%0A%0A%40enduml</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2497" height="1379"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 81.67601649999999 128.65457617231817 L 81.67601649999999 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 367.26959213352865 128.65457617231817 L 367.26959213352865 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 548.9841476540989 128.65457617231817 L 548.9841476540989 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 842.351511739776 128.65457617231817 L 842.351511739776 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1223.728870332289 128.65457617231817 L 1223.728870332289 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1456.394787884763 128.65457617231817 L 1456.394787884763 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1733.8351652761041 128.65457617231817 L 1733.8351652761041 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2040.6527857094375 128.65457617231817 L 2040.6527857094375 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2169.8512432075468 128.65457617231817 L 2169.8512432075468 1379.931148952318" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 90.987082381 59.55666621331818 A 9.311065881 9.311065881 0 1 1 90.98707772546743 59.54735514898902" stroke-miterlimit="10" stroke-width="2.7769845610000004" stroke-dasharray=""/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 81.67601649999999 68.86773209431819 L 81.67601649999999 88.79668012031819 M 69.914670124 76.05522154631818 L 93.43736287599998 76.05522154631818 M 81.67601649999999 88.79668012031819 L 69.914670124 107.41881188231818 M 81.67601649999999 88.79668012031819 L 93.43736287599998 107.41881188231818" stroke-miterlimit="10" stroke-width="2.7769845610000004"/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.20000331640624" y="123.75401518231817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 322.66330530547003 84.54952726231818 L 411.8758789615872 84.54952726231818 L 411.8758789615872 128.65457617231817 L 322.66330530547003 128.65457617231817 L 322.66330530547003 84.54952726231818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="340.38700088597005" y="112.31937287231818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 428.2110822615872 84.71287929531819 L 669.7572130466107 84.71287929531819 L 669.7572130466107 128.65457617231817 L 428.2110822615872 128.65457617231817 L 428.2110822615872 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.9347778420872" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">OAuth Provider (HCMUT_SSO)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 775.7373590059557 84.71287929531819 L 908.9656644735963 84.71287929531819 L 908.9656644735963 128.65457617231817 L 775.7373590059557 128.65457617231817 L 775.7373590059557 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="793.4610545864557" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Auth Controller</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1164.4482899861641 84.71287929531819 L 1283.0094506784142 84.71287929531819 L 1283.0094506784142 128.65457617231817 L 1164.4482899861641 128.65457617231817 L 1164.4482899861641 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1182.171985566664" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Auth Service</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1396.7169297066068 84.71287929531819 L 1516.0726460629194 84.71287929531819 L 1516.0726460629194 128.65457617231817 L 1396.7169297066068 128.65457617231817 L 1396.7169297066068 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1414.4406252871067" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User Service</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1663.5631756282214 84.71287929531819 L 1804.107154923987 84.71287929531819 L 1804.107154923987 128.65457617231817 L 1663.5631756282214 128.65457617231817 L 1663.5631756282214 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1681.2868712087213" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User Repository</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1991.5511451826485 84.54952726231818 L 2089.7544262362267 84.54952726231818 L 2089.7544262362267 128.65457617231817 L 1991.5511451826485 128.65457617231817 L 1991.5511451826485 84.54952726231818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2009.2748407631484" y="112.31937287231818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Database</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 2106.0896295362263 84.71287929531819 L 2233.6128568788668 84.71287929531819 L 2233.6128568788668 128.65457617231817 L 2106.0896295362263 128.65457617231817 L 2106.0896295362263 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2123.8133251167264" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Token Service</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 73.50841485 136.82217782231817 L 89.84361814999998 136.82217782231817 L 89.84361814999998 1363.5959456523178 L 73.50841485 1363.5959456523178 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 359.10199048352865 136.82217782231817 L 375.43719378352864 136.82217782231817 L 375.43719378352864 1363.5959456523178 L 359.10199048352865 1363.5959456523178 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 834.183910089776 228.29931630231818 L 850.5191133897761 228.29931630231818 L 850.5191133897761 1252.516563212318 L 834.183910089776 1252.516563212318 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 540.8165460040989 274.0378855423182 L 557.151749304099 274.0378855423182 L 557.151749304099 411.2535932623182 L 540.8165460040989 411.2535932623182 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1215.561268682289 456.9921625023182 L 1231.896471982289 456.9921625023182 L 1231.896471982289 1206.777993972318 L 1215.561268682289 1206.777993972318 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1448.227186234763 502.7307317423182 L 1464.562389534763 502.7307317423182 L 1464.562389534763 731.4235779423179 L 1448.227186234763 731.4235779423179 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1725.667563626104 548.4693009823181 L 1742.0027669261042 548.4693009823181 L 1742.0027669261042 685.685008702318 L 1725.667563626104 685.685008702318 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 2032.4851840594374 594.2078702223181 L 2048.8203873594375 594.2078702223181 L 2048.8203873594375 639.946439462318 L 2032.4851840594374 639.946439462318 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 2161.6836415575467 821.2671960923179 L 2178.018844857547 821.2671960923179 L 2178.018844857547 933.9800988623178 L 2161.6836415575467 933.9800988623178 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1141.7980346679688" y="24.651306798181814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Login Flow with OAuth</text></g><g><rect fill="white" stroke="none" x="109.17360872166667" y="161.32498277231818" width="230.59839119019531" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.62388921666667" y="176.02666574231816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Select role (mentee/mentor/admin)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361814999998 182.56074706231817 L 345.652673099862 182.56074706231817" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(359.10199048352865,182.56074706231817) translate(-359.10199048352865,-182.56074706231817)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 345.489321066862 175.75441235398483 L 359.10199048352865 182.56074706231817 L 345.489321066862 189.3670817706515 Z"/></g></g><g><rect fill="white" stroke="none" x="499.07111738891786" y="207.06355201231818" width="211.47886909546875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="501.52139788391787" y="221.76523498231816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /api/auth/signin?role=[role]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 375.43719378352864 228.29931630231818 L 820.7345927061093 228.29931630231818" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(834.183910089776,228.29931630231818) translate(-834.183910089776,-228.29931630231818)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 820.5712406731093 221.49298159398484 L 834.183910089776 228.29931630231818 L 820.5712406731093 235.1056510106515 Z"/></g></g><g><rect fill="white" stroke="none" x="617.433750984164" y="252.80212125231822" width="156.46815742554688" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="619.884031479164" y="267.5038042223182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Redirect to OAuth login</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 834.183910089776 274.0378855423182 L 570.6010666877656 274.0378855423182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(557.151749304099,274.0378855423182) translate(-557.151749304099,-274.0378855423182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 570.7644187207657 267.23155083398484 L 557.151749304099 274.0378855423182 L 570.7644187207657 280.8442202506515 Z"/></g></g><g><rect fill="white" stroke="none" x="242.7975109326354" y="298.54069049231816" width="145.06514228882813" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="245.24779142763538" y="313.24237346231814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Show consent screen</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 540.8165460040989 319.7764547823182 L 103.29293553366665 319.7764547823182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(89.84361814999998,319.7764547823182) translate(-89.84361814999998,-319.7764547823182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.45628756666665 312.97012007398484 L 89.84361814999998 319.7764547823182 L 103.45628756666665 326.5827894906515 Z"/></g></g><g><rect fill="white" stroke="none" x="257.07094843263536" y="344.27925973231817" width="116.51826728882813" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="259.5212289276354" y="358.98094270231815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Grant permission</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361814999998 365.5150240223182 L 527.3672286204322 365.5150240223182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(540.8165460040989,365.5150240223182) translate(-540.8165460040989,-365.5150240223182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 527.2038765874322 358.70868931398485 L 540.8165460040989 365.5150240223182 L 527.2038765874322 372.3213587306515 Z"/></g></g><g><rect fill="white" stroke="none" x="576.4817398757656" y="390.01782897231817" width="238.37217964234375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="578.9320203707656" y="404.71951194231815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return authorization code + redirect</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 557.151749304099 411.2535932623182 L 820.7345927061093 411.2535932623182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(834.183910089776,411.2535932623182) translate(-834.183910089776,-411.2535932623182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 820.5712406731093 404.44725855398485 L 834.183910089776 411.2535932623182 L 820.5712406731093 418.05992797065153 Z"/></g></g><g><rect fill="white" stroke="none" x="933.2027035097824" y="435.7563982123182" width="199.6749750525" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="935.6529840047824" y="450.45808118231815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">handleSignIn(profile, account)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 850.5191133897761 456.9921625023182 L 1202.1119512986222 456.9921625023182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1215.561268682289,456.9921625023182) translate(-1215.561268682289,-456.9921625023182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1201.9485992656223 450.18582779398486 L 1215.561268682289 456.9921625023182 L 1201.9485992656223 463.79849721065153 Z"/></g></g><g><rect fill="white" stroke="none" x="1263.882170866944" y="481.4949674523182" width="152.35931648316406" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1266.332451361944" y="496.19665042231816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">findUser(email, profile)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1231.896471982289 502.7307317423182 L 1434.7778688510962 502.7307317423182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1448.227186234763,502.7307317423182) translate(-1448.227186234763,-502.7307317423182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1434.6145168180963 495.92439703398486 L 1448.227186234763 502.7307317423182 L 1434.6145168180963 509.53706645065154 Z"/></g></g><g><rect fill="white" stroke="none" x="1483.8923801064295" y="527.2335366923181" width="222.44519294800781" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1486.3426606014295" y="541.9352196623181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">findByEmail and Role(email, role)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.562389534763 548.4693009823181 L 1712.2182462424373 548.4693009823181" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1725.667563626104,548.4693009823181) translate(-1725.667563626104,-548.4693009823181)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1712.0548942094374 541.6629662739848 L 1725.667563626104 548.4693009823181 L 1712.0548942094374 555.2756356906515 Z"/></g></g><g><rect fill="white" stroke="none" x="1761.332757497771" y="572.9721059323181" width="251.82243599" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1763.783037992771" y="587.673788902318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">user.findUnique({where: {email, role}})</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1742.0027669261042 594.2078702223181 L 2019.0358666757706 594.2078702223181" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(2032.4851840594374,594.2078702223181) translate(-2032.4851840594374,-594.2078702223181)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 2018.8725146427707 587.4015355139848 L 2032.4851840594374 594.2078702223181 L 2018.8725146427707 601.0142049306514 Z"/></g></g><g><rect fill="white" stroke="none" x="1835.6276488551928" y="618.710675172318" width="103.23265327515625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1838.0779293501928" y="633.412358142318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User data | null</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2032.4851840594374 639.946439462318 L 1755.452084309771 639.946439462318" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1742.0027669261042,639.946439462318) translate(-1742.0027669261042,-639.946439462318)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1755.6154363427709 633.1401047539847 L 1742.0027669261042 639.946439462318 L 1755.6154363427709 646.7527741706514 Z"/></g></g><g><rect fill="white" stroke="none" x="1543.4986499428553" y="664.449244412318" width="103.23265327515625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1545.9489304378553" y="679.150927382318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User data | null</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1725.667563626104 685.685008702318 L 1478.0117069184298 685.685008702318" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1464.562389534763,685.685008702318) translate(-1464.562389534763,-685.685008702318)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1478.1750589514297 678.8786739939846 L 1464.562389534763 685.685008702318 L 1478.1750589514297 692.4913434106513 Z"/></g></g><g><rect fill="white" stroke="none" x="1299.3223793020027" y="710.1878136523179" width="81.47889961304688" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1301.7726597970027" y="724.8894966223179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User record</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1448.227186234763 731.4235779423179 L 1245.3457893659559 731.4235779423179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1231.896471982289,731.4235779423179) translate(-1231.896471982289,-731.4235779423179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1245.5091413989558 724.6172432339846 L 1231.896471982289 731.4235779423179 L 1245.5091413989558 738.2299126506513 Z"/></g></g><g><rect fill="white" stroke="none" x="1580.2596447441563" y="800.0314318023179" width="233.06082405152344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1582.7099252391563" y="814.7331147723179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">createToken({userId, email, name})</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1231.896471982289 821.2671960923179 L 2148.23432417388 821.2671960923179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(2161.6836415575467,821.2671960923179) translate(-2161.6836415575467,-821.2671960923179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 2148.0709721408803 814.4608613839846 L 2161.6836415575467 821.2671960923179 L 2148.0709721408803 828.0735308006513 Z"/></g></g><g><rect fill="white" stroke="none" x="2197.3488354292135" y="845.7700010423179" width="278.5940424353125" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2199.7991159242133" y="860.4716840123178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">jwt.sign(payload, secret, {expiresIn: '24h'})</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2178.018844857547 867.0057653323179 L 2243.3596580575468 867.0057653323179 L 2243.3596580575468 888.2415296223179 L 2191.4681622412136 888.2415296223179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(2178.018844857547,888.2415296223179) translate(-2178.018844857547,-888.2415296223179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 2191.6315142742133 881.4351949139846 L 2178.018844857547 888.2415296223179 L 2191.6315142742133 895.0478643306512 Z"/></g></g><g><rect fill="white" stroke="none" x="1634.461488005875" y="912.7443345723178" width="124.65713752808594" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1636.911768500875" y="927.4460175423178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">JWT access token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2161.6836415575467 933.9800988623178 L 1245.3457893659559 933.9800988623178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1231.896471982289,933.9800988623178) translate(-1231.896471982289,-933.9800988623178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1245.5091413989558 927.1737641539845 L 1231.896471982289 933.9800988623178 L 1245.5091413989558 940.7864335706512 Z"/></g></g><g><rect fill="white" stroke="none" x="965.3930874209152" y="958.4829038123178" width="135.29420723023438" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="967.8433679159152" y="973.1845867823178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{user, accessToken}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1215.561268682289 979.7186681023178 L 863.9684307734427 979.7186681023178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(850.5191133897761,979.7186681023178) translate(-850.5191133897761,-979.7186681023178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 864.1317828064427 972.9123333939845 L 850.5191133897761 979.7186681023178 L 864.1317828064427 986.5250028106511 Z"/></g></g><g><rect fill="white" stroke="none" x="496.22574995727723" y="1004.2214730523177" width="217.16960395875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="498.67603045227725" y="1018.9231560223177" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set session cookie + redirect to /</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 834.183910089776 1025.4572373423177 L 388.8865111671953 1025.4572373423177" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(375.43719378352864,1025.4572373423177) translate(-375.43719378352864,-1025.4572373423177)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 389.0498632001953 1018.6509026339844 L 375.43719378352864 1025.4572373423177 L 389.0498632001953 1032.263572050651 Z"/></g></g><g><rect fill="white" stroke="none" x="161.30314058201824" y="1049.960042292318" width="126.33932746949219" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="163.75342107701823" y="1064.661725262318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Render homepage</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 359.10199048352865 1071.1958065823178 L 103.29293553366665 1071.1958065823178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(89.84361814999998,1071.1958065823178) translate(-89.84361814999998,-1071.1958065823178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.45628756666665 1064.3894718739846 L 89.84361814999998 1071.1958065823178 L 103.45628756666665 1078.002141290651 Z"/></g></g><g><rect fill="white" stroke="none" x="1255.3102633789556" y="1139.803660442318" width="177.67073310914063" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1257.7605438739556" y="1154.505343412318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Throw exception not found</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1456.394787884763 1161.039424732318 L 1245.3457893659559 1161.039424732318" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1231.896471982289,1161.039424732318) translate(-1231.896471982289,-1161.039424732318)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1245.5091413989558 1154.2330900239847 L 1231.896471982289 1161.039424732318 L 1245.5091413989558 1167.8457594406511 Z"/></g></g><g><rect fill="white" stroke="none" x="869.8491039614426" y="1185.542229682318" width="326.3821894079687" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="872.2993844564426" y="1200.2439126523182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return 403: Unauthorized + redirect to /error_403</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1215.561268682289 1206.777993972318 L 863.9684307734427 1206.777993972318" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(850.5191133897761,1206.777993972318) translate(-850.5191133897761,-1206.777993972318)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 864.1317828064427 1199.9716592639847 L 850.5191133897761 1206.777993972318 L 864.1317828064427 1213.5843286806512 Z"/></g></g><g><rect fill="white" stroke="none" x="531.0610923645038" y="1231.2807989223181" width="147.49891914429688" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="533.5113728595038" y="1245.9824818923182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Redirect to error page</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 834.183910089776 1252.516563212318 L 388.8865111671953 1252.516563212318" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(375.43719378352864,1252.516563212318) translate(-375.43719378352864,-1252.516563212318)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 389.0498632001953 1245.7102285039848 L 375.43719378352864 1252.516563212318 L 389.0498632001953 1259.3228979206513 Z"/></g></g><g><rect fill="white" stroke="none" x="162.1263446225456" y="1277.0193681623182" width="124.6929193884375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="164.57662511754557" y="1291.7210511323183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Render error page</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 359.10199048352865 1298.255132452318 L 103.29293553366665 1298.255132452318" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(89.84361814999998,1298.255132452318) translate(-89.84361814999998,-1298.255132452318)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.45628756666665 1291.4487977439849 L 89.84361814999998 1298.255132452318 L 103.45628756666665 1305.0614671606513 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.33520329999999 755.926382892318 L 2481.660199019526 755.926382892318 L 2481.660199019526 1322.757937402318 L 16.33520329999999 1322.757937402318 L 16.33520329999999 755.926382892318 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 16.33520329999999 755.926382892318 L 16.33520329999999 775.528626852318 L 62.6944068970703 775.528626852318 L 72.4955288770703 765.7275048723179 L 72.4955288770703 755.926382892318 L 16.33520329999999 755.926382892318" stroke-miterlimit="10" stroke-width="2.3336004714285714"/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="32.67040659999999" y="768.9945455323179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="86.3804516820703" y="757.2331991563179" width="84.43306221070313" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="88.8307321770703" y="768.9945455323179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[If user exists]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.33520329999999 1095.698611532318 L 2481.660199019526 1095.698611532318" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray="4.083800825"/></g><g/><g><rect fill="white" stroke="none" x="86.3804516820703" y="1097.005427796318" width="96.1172357946875" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="88.8307321770703" y="1108.7667741723178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[User not found]</text></g><g/></g><g/><g/><g/></g></svg>