<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1400.9824866899635" height="1223.1131972723178"><desc>%40startuml%0Atitle%20AI%20Chatbot%20-%20Streaming%20Chat%20Flow%0A%0Aactor%20User%0Aparticipant%20Browser%0Aparticipant%20ChatInterface%0Aparticipant%20%22PostController%22%20as%20PostController%0Aparticipant%20%22Auth%20Service%22%20as%20AuthService%0Aparticipant%20Database%0Aparticipant%20%22RAG%20Chatbot%20Service%22%20as%20RAGChatbot%0Aparticipant%20%22Vector%20Store%20(Pinecone)%22%20as%20VectorStore%0Aparticipant%20%22LLMs%20API%22%20as%20GeminiAPI%0A%0Aactivate%20User%0Aactivate%20Browser%0A%0AUser%20-%3E%20Browser%3A%20Type%20question%0ABrowser%20-%3E%20User%3A%20Update%20input%0AUser%20-%3E%20Browser%3A%20Click%20send%0ABrowser%20-%3E%20PostController%3A%20POST%20%2Fapi%2Fchatbot%2Fstream%0A%0Aactivate%20PostController%0APostController%20-%3E%20AuthService%3A%20Verify%20session%0Aactivate%20AuthService%0AAuthService%20-%3E%20PostController%3A%20User%20data%0Adeactivate%20AuthService%0APostController%20-%3E%20RAGChatbot%3A%20Call%20chatStream()%0Aactivate%20RAGChatbot%0ARAGChatbot%20-%3E%20VectorStore%3A%20Similarity%20search%0Aactivate%20VectorStore%0AVectorStore%20-%3E%20RAGChatbot%3A%20Relevant%20documents%0Adeactivate%20VectorStore%0ARAGChatbot%20-%3E%20GeminiAPI%3A%20Stream%20request%0Aactivate%20GeminiAPI%0Aloop%20For%20each%20chunk%0A%20%20%20%20GeminiAPI%20-%3E%20RAGChatbot%3A%20%5BStream%20chunk%5D%0A%20%20%20%20RAGChatbot%20-%3E%20PostController%3A%20%5BChunk%5D%0A%20%20%20%20PostController%20-%3E%20Browser%3A%20SSE%3A%20data%3A%20%7Bchunk%3A%20%22...%22%7D%0A%20%20%20%20Browser%20-%3E%20ChatInterface%3A%20Append%20to%20message%0A%20%20%20%20activate%20ChatInterface%0Aend%20loop%0AGeminiAPI%20-%3E%20RAGChatbot%3A%20%5BStream%20complete%5D%0Adeactivate%20GeminiAPI%0ARAGChatbot%20-%3E%20PostController%3A%20Full%20response%0Adeactivate%20RAGChatbot%0APostController%20-%3E%20Database%3A%20Save%20messages%0Aactivate%20Database%0ADatabase%20-%3E%20PostController%3A%20Success%0Adeactivate%20Database%0APostController%20-%3E%20Browser%3A%20SSE%3A%20data%3A%20%7Bdone%3A%20true%2C%20conversationId%7D%0Adeactivate%20PostController%0ABrowser%20-%3E%20ChatInterface%3A%20Finalize%20message%0AChatInterface%20-%3E%20User%3A%20Display%20final%20message%0Adeactivate%20ChatInterface%0A%0A%40enduml</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1400" height="1223"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 23.64361483359375 128.65457617231817 L 23.64361483359375 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 174.8206407845052 128.65457617231817 L 174.8206407845052 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 365.1172040889322 128.65457617231817 L 365.1172040889322 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 529.9649172251302 128.65457617231817 L 529.9649172251302 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 680.3044035031901 128.65457617231817 L 680.3044035031901 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 805.0218276761042 128.65457617231817 L 805.0218276761042 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 958.2539308040964 128.65457617231817 L 958.2539308040964 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1157.9283709682213 128.65457617231817 L 1157.9283709682213 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1319.3064701899634 128.65457617231817 L 1319.3064701899634 1223.1131972723178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 32.95468071459375 59.55666621331818 A 9.311065881 9.311065881 0 1 1 32.9546760590612 59.54735514898902" stroke-miterlimit="10" stroke-width="2.7769845610000004" stroke-dasharray=""/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 23.64361483359375 68.86773209431819 L 23.64361483359375 88.79668012031819 M 11.882268457593753 76.05522154631818 L 35.40496120959375 76.05522154631818 M 23.64361483359375 88.79668012031819 L 11.882268457593753 107.41881188231818 M 23.64361483359375 88.79668012031819 L 35.40496120959375 107.41881188231818" stroke-miterlimit="10" stroke-width="2.7769845610000004"/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="8.167601650000002" y="123.75401518231817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 130.2143539564466 84.54952726231818 L 219.4269276125638 84.54952726231818 L 219.4269276125638 128.65457617231817 L 130.2143539564466 128.65457617231817 L 130.2143539564466 84.54952726231818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="147.9380495369466" y="112.31937287231818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 303.38851125501424 84.54952726231818 L 426.8458969228502 84.54952726231818 L 426.8458969228502 128.65457617231817 L 303.38851125501424 128.65457617231817 L 303.38851125501424 84.54952726231818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="321.11220683551426" y="112.31937287231818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ChatInterface</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 465.7988693497083 84.71287929531819 L 594.1309651005521 84.71287929531819 L 594.1309651005521 128.65457617231817 L 465.7988693497083 128.65457617231817 L 465.7988693497083 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="483.5225649302083" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PostController</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 621.0238231570651 84.71287929531819 L 739.5849838493151 84.71287929531819 L 739.5849838493151 128.65457617231817 L 621.0238231570651 128.65457617231817 L 621.0238231570651 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="638.7475187375651" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Auth Service</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 755.9201871493151 84.54952726231818 L 854.1234682028933 84.54952726231818 L 854.1234682028933 128.65457617231817 L 755.9201871493151 128.65457617231817 L 755.9201871493151 84.54952726231818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="773.6438827298151" y="112.31937287231818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Database</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 870.4586715028933 84.71287929531819 L 1046.0491901052994 84.71287929531819 L 1046.0491901052994 128.65457617231817 L 870.4586715028933 128.65457617231817 L 870.4586715028933 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="888.1823670833933" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAG Chatbot Service</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1062.3843934052995 84.71287929531819 L 1253.4723485311433 84.71287929531819 L 1253.4723485311433 128.65457617231817 L 1062.3843934052995 128.65457617231817 L 1062.3843934052995 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1080.1080889857994" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Vector Store (Pinecone)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1269.8075518311432 84.71287929531819 L 1368.8053885487839 84.71287929531819 L 1368.8053885487839 128.65457617231817 L 1269.8075518311432 128.65457617231817 L 1269.8075518311432 84.71287929531819 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1287.531247411643" y="112.3193728723182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">LLMs API</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.476013183593752 136.82217782231817 L 31.811216483593753 136.82217782231817 L 31.811216483593753 1206.7779939723177 L 15.476013183593752 1206.7779939723177 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 166.6530391345052 136.82217782231817 L 182.9882424345052 136.82217782231817 L 182.9882424345052 1206.7779939723177 L 166.6530391345052 1206.7779939723177 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 521.7973155751301 319.7764547823182 L 538.1325188751302 319.7764547823182 L 538.1325188751302 1074.4628472423178 L 521.7973155751301 1074.4628472423178 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 672.13680185319 365.5150240223182 L 688.4720051531901 365.5150240223182 L 688.4720051531901 411.2535932623182 L 672.13680185319 411.2535932623182 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 950.0863291540963 456.9921625023182 L 966.4215324540965 456.9921625023182 L 966.4215324540965 937.2471395223178 L 950.0863291540963 937.2471395223178 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1149.7607693182213 502.7307317423182 L 1166.0959726182214 502.7307317423182 L 1166.0959726182214 548.4693009823181 L 1149.7607693182213 548.4693009823181 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1311.1388685399634 594.2078702223181 L 1327.4740718399635 594.2078702223181 L 1327.4740718399635 891.5085702823178 L 1311.1388685399634 891.5085702823178 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 356.94960243893223 821.2671960923178 L 373.2848057389322 821.2671960923178 L 373.2848057389322 1165.939985722318 L 356.94960243893223 1165.939985722318 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 796.8542260261041 982.9857087623177 L 813.1894293261042 982.9857087623177 L 813.1894293261042 1028.7242780023178 L 796.8542260261041 1028.7242780023178 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="540.5511322021484" y="24.651306798181814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AI Chatbot - Streaming Chat Flow</text></g><g><rect fill="white" stroke="none" x="51.14120705526042" y="161.32498277231818" width="96.18184150757813" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="53.591487550260425" y="176.02666574231816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Type question</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 31.811216483593753 182.56074706231817 L 153.20372175083855 182.56074706231817" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(166.6530391345052,182.56074706231817) translate(-166.6530391345052,-182.56074706231817)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 153.04036971783853 175.75441235398483 L 166.6530391345052 182.56074706231817 L 153.04036971783853 189.3670817706515 Z"/></g></g><g><rect fill="white" stroke="none" x="55.214212731529955" y="207.06355201231818" width="88.03583015503906" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="57.664493226529956" y="221.76523498231816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Update input</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 166.6530391345052 228.29931630231818 L 45.26053386726042 228.29931630231818" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(31.811216483593753,228.29931630231818) translate(-31.811216483593753,-228.29931630231818)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 45.42388590026042 221.49298159398484 L 31.811216483593753 228.29931630231818 L 45.42388590026042 235.1056510106515 Z"/></g></g><g><rect fill="white" stroke="none" x="62.97012551229167" y="252.80212125231822" width="72.52400459351563" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="65.42040600729167" y="267.5038042223182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Click send</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 31.811216483593753 274.0378855423182 L 153.20372175083855 274.0378855423182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(166.6530391345052,274.0378855423182) translate(-166.6530391345052,-274.0378855423182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 153.04036971783853 267.23155083398484 L 166.6530391345052 274.0378855423182 L 153.04036971783853 280.8442202506515 Z"/></g></g><g><rect fill="white" stroke="none" x="265.61181003325515" y="298.54069049231816" width="173.561937943125" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="268.06209052825517" y="313.24237346231814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /api/chatbot/stream</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 182.9882424345052 319.7764547823182 L 508.3479981914635 319.7764547823182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(521.7973155751301,319.7764547823182) translate(-521.7973155751301,-319.7764547823182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 508.18464615846347 312.97012007398484 L 521.7973155751301 319.7764547823182 L 508.18464615846347 326.5827894906515 Z"/></g></g><g><rect fill="white" stroke="none" x="557.4625094467968" y="344.27925973231817" width="95.34430183472656" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="559.9127899417969" y="358.98094270231815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verify session</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 538.1325188751302 365.5150240223182 L 658.6874844695234 365.5150240223182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(672.13680185319,365.5150240223182) translate(-672.13680185319,-365.5150240223182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 658.5241324365234 358.70868931398485 L 672.13680185319 365.5150240223182 L 658.5241324365234 372.3213587306515 Z"/></g></g><g><rect fill="white" stroke="none" x="570.9055789048047" y="390.01782897231817" width="68.45816291871094" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="573.3558593998047" y="404.71951194231815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User data</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 672.13680185319 411.2535932623182 L 551.5818362587969 411.2535932623182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(538.1325188751302,411.2535932623182) translate(-538.1325188751302,-411.2535932623182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 551.7451882917969 404.44725855398485 L 538.1325188751302 411.2535932623182 L 551.7451882917969 418.05992797065153 Z"/></g></g><g><rect fill="white" stroke="none" x="684.6334019424648" y="435.7563982123182" width="118.95204414429688" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="687.0836824374649" y="450.45808118231815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Call chatStream()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 538.1325188751302 456.9921625023182 L 936.6370117704297 456.9921625023182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(950.0863291540963,456.9921625023182) translate(-950.0863291540963,-456.9921625023182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 936.4736597374297 450.18582779398486 L 950.0863291540963 456.9921625023182 L 936.4736597374297 463.79849721065153 Z"/></g></g><g><rect fill="white" stroke="none" x="1001.8756955254362" y="481.4949674523182" width="112.43091072144531" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1004.3259760204362" y="496.19665042231816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Similarity search</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 966.4215324540965 502.7307317423182 L 1136.3114519345545 502.7307317423182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1149.7607693182213,502.7307317423182) translate(-1149.7607693182213,-502.7307317423182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1136.1480999015546 495.92439703398486 L 1149.7607693182213 502.7307317423182 L 1136.1480999015546 509.53706645065154 Z"/></g></g><g><rect fill="white" stroke="none" x="988.8191311943815" y="527.2335366923181" width="138.5440393835547" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.2694116893815" y="541.9352196623181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Relevant documents</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1149.7607693182213 548.4693009823181 L 979.8708498377631 548.4693009823181" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(966.4215324540965,548.4693009823181) translate(-966.4215324540965,-548.4693009823181)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 980.0342018707631 541.6629662739848 L 966.4215324540965 548.4693009823181 L 980.0342018707631 555.2756356906515 Z"/></g></g><g><rect fill="white" stroke="none" x="1086.2189886055455" y="572.9721059323181" width="105.12242378296875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1088.6692691005455" y="587.673788902318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Stream request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 966.4215324540965 594.2078702223181 L 1297.6895511562966 594.2078702223181" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(1311.1388685399634,594.2078702223181) translate(-1311.1388685399634,-594.2078702223181)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1297.5261991232967 587.4015355139848 L 1311.1388685399634 594.2078702223181 L 1297.5261991232967 601.0142049306514 Z"/></g></g><g><rect fill="white" stroke="none" x="1087.0350210152135" y="662.815724082318" width="103.49035896363281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1089.4853015102135" y="677.5174070523179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Stream chunk]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1311.1388685399634 684.051488372318 L 979.8708498377631 684.051488372318" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(966.4215324540965,684.051488372318) translate(-966.4215324540965,-684.051488372318)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 980.0342018707631 677.2451536639846 L 966.4215324540965 684.051488372318 L 980.0342018707631 690.8578230806513 Z"/></g></g><g><rect fill="white" stroke="none" x="716.3978749038906" y="708.5542933223179" width="55.423098221445315" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.8481553988906" y="723.2559762923179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Chunk]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 950.0863291540963 729.7900576123179 L 551.5818362587969 729.7900576123179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(538.1325188751302,729.7900576123179) translate(-538.1325188751302,-729.7900576123179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 551.7451882917969 722.9837229039846 L 538.1325188751302 729.7900576123179 L 551.7451882917969 736.5963923206513 Z"/></g></g><g><rect fill="white" stroke="none" x="273.0205395864778" y="754.2928625623179" width="158.7444788366797" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.4708200814778" y="768.9945455323178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SSE: data: {chunk: "..."}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 521.7973155751301 775.5286268523179 L 196.43755981817185 775.5286268523179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(182.9882424345052,775.5286268523179) translate(-182.9882424345052,-775.5286268523179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 196.60091185117187 768.7222921439845 L 182.9882424345052 775.5286268523179 L 196.60091185117187 782.3349615606512 Z"/></g></g><g><rect fill="white" stroke="none" x="202.31823300617182" y="800.0314318023178" width="135.30137886109375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="204.7685135011718" y="814.7331147723178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Append to message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 182.9882424345052 821.2671960923178 L 343.5002850552656 821.2671960923178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(356.94960243893223,821.2671960923178) translate(-356.94960243893223,-821.2671960923178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 343.33693302226555 814.4608613839845 L 356.94960243893223 821.2671960923178 L 343.33693302226555 828.0735308006512 Z"/></g></g><g><rect fill="white" stroke="none" x="1076.8524877510533" y="870.2728059923178" width="123.85542549195313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1079.3027682460533" y="884.9744889623178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Stream complete]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1311.1388685399634 891.5085702823178 L 979.8708498377631 891.5085702823178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(966.4215324540965,891.5085702823178) translate(-966.4215324540965,-891.5085702823178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 980.0342018707631 884.7022355739845 L 966.4215324540965 891.5085702823178 L 980.0342018707631 898.3149049906511 Z"/></g></g><g><rect fill="white" stroke="none" x="697.657732081625" y="916.0113752323177" width="92.90338386597656" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="700.108012576625" y="930.7130582023177" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Full response</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 950.0863291540963 937.2471395223178 L 551.5818362587969 937.2471395223178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(538.1325188751302,937.2471395223178) translate(-538.1325188751302,-937.2471395223178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 551.7451882917969 930.4408048139844 L 538.1325188751302 937.2471395223178 L 551.7451882917969 944.0534742306511 Z"/></g></g><g><rect fill="white" stroke="none" x="612.8920757202657" y="961.7499444723177" width="109.20259346070313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="615.3423562152657" y="976.4516274423177" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Save messages</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 538.1325188751302 982.9857087623177 L 783.4049086424375 982.9857087623177" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(796.8542260261041,982.9857087623177) translate(-796.8542260261041,-982.9857087623177)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 783.2415566094375 976.1793740539844 L 796.8542260261041 982.9857087623177 L 783.2415566094375 989.792043470651 Z"/></g></g><g><rect fill="white" stroke="none" x="637.3408901123555" y="1007.4885137123177" width="60.30496467652344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="639.7911706073555" y="1022.1901966823177" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Success</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 796.8542260261041 1028.7242780023178 L 551.5818362587969 1028.7242780023178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(538.1325188751302,1028.7242780023178) translate(-538.1325188751302,-1028.7242780023178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 551.7451882917969 1021.9179432939844 L 538.1325188751302 1028.7242780023178 L 551.7451882917969 1035.530612710651 Z"/></g></g><g><rect fill="white" stroke="none" x="223.21025974028643" y="1053.227082952318" width="258.3650385290625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="225.66054023528642" y="1067.928765922318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SSE: data: {done: true, conversationId}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 521.7973155751301 1074.4628472423178 L 196.43755981817185 1074.4628472423178" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(182.9882424345052,1074.4628472423178) translate(-182.9882424345052,-1074.4628472423178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 196.60091185117187 1067.6565125339846 L 182.9882424345052 1074.4628472423178 L 196.60091185117187 1081.269181950651 Z"/></g></g><g><rect fill="white" stroke="none" x="210.48215817707026" y="1098.965652192318" width="118.97352851929688" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="212.93243867207025" y="1113.667335162318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Finalize message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 182.9882424345052 1120.2014164823179 L 343.5002850552656 1120.2014164823179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(356.94960243893223,1120.2014164823179) translate(-356.94960243893223,-1120.2014164823179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 343.33693302226555 1113.3950817739847 L 356.94960243893223 1120.2014164823179 L 343.33693302226555 1127.007751190651 Z"/></g></g><g><rect fill="white" stroke="none" x="120.63452807514973" y="1144.704221432318" width="147.49176277222656" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="123.08480857014973" y="1159.4059044023181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Display final message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 356.94960243893223 1165.939985722318 L 45.26053386726042 1165.939985722318" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(31.811216483593753,1165.939985722318) translate(-31.811216483593753,-1165.939985722318)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 45.42388590026042 1159.1336510139847 L 31.811216483593753 1165.939985722318 L 45.42388590026042 1172.7463204306512 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 109.47982758450522 618.710675172318 L 1376.4796817399633 618.710675172318 L 1376.4796817399633 845.7700010423179 L 109.47982758450522 845.7700010423179 L 109.47982758450522 618.710675172318 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714"/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 109.47982758450522 618.710675172318 L 109.47982758450522 638.312919132318 L 166.90462871575522 638.312919132318 L 176.70575069575523 628.511797152318 L 176.70575069575523 618.710675172318 L 109.47982758450522 618.710675172318" stroke-miterlimit="10" stroke-width="2.3336004714285714"/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="125.81503088450522" y="631.778837812318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">loop</text><g><rect fill="white" stroke="none" x="190.59067350075523" y="620.017491436318" width="99.40486396851563" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="193.04095399575522" y="631.778837812318" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[For each chunk]</text></g></g><g/><g/><g/><g/></g></svg>